% 方式設計仕様書(Group18)
% 1029-28-9483 勝田 峻太朗
 1029-28-1547 住江 祐哉
% \西暦 \today

# 概要

設計したプロセッサは,5ステージのマルチサイクル方式のプロセッサである.


# 命令セットアーキテクチャ

SIMPLEアーキテクチャと基本的には同じである.
まず,以下のような命令の形式を定める.

## 形式

### R形式

```
#-----|----|----|-----|---#
| op1 | rs | rd | op3 | d |
#15---|13--|10--|7----|3--#
```

### I形式

```
#-----|----|----|-----|---#
| op1 | ra | rb |    d    |
#15---|13--|10--|7--------#
```

## 演算命令と停止･入出力命令

演算命令と停止･入出力命令では,R形式を用い,`op1`の値は`11`である.

| name | value                       |
|:-----|:----------------------------|
| op1  | 11                          |
| rs   | source register number      |
| rd   | destination register number |
| op3  | 演算コード                   |
| d    | シフト演算のときのシフト数      |

: 演算命令のときの各値の対応 {#tbl:arithmetic-operations}

ただし,演算コードは以下のように定める.

| code | 計算                  |
|:-----|:----------------------|
| 0000 | in1 + in2             |
| 0001 | in1 - in2             |
| 1000 | in1 & in2 (bitwise)   |
| 1001 | in1 `|` in2 (bitwise) |
| 1010 | in1 << i2             |
| 1011 | in1 >> in2            |

: 演算コードの対応 {#tbl:opcode}

| code | 操作 |
|:-----|:-----|
| 1111 | 停止 |
| 1100 | 入力 |
| 1101 | 出力 |

: 停止･入出力命令のときの演算コード {#tbl:special-opcode}


### 算術演算

算術演算は,演算コードが0で始まる.
このときの動作は,
$$ r[rd] = op3(r[rd], r[rs]) $$
である.

### ビット演算

ビット演算は演算コードが1ではじまる.
このときの動作は,
$$ r[rd] = op3(r[rs], d) $$
である.

### 停止/入出力命令

停止命令
: 動作を停止させることができる.

入力命令
: ボード上のスイッチを押すことで動作が開始するようにできるようにする.
$$ r[rd] = input $$

出力命令
: ボード上の7SEGLEDに指定したデータを出力できる.
$$ output = r[rs] $$ 

## ロード,ストア命令

ロード,ストア命令はI形式を用いる.

### ロード命令

ロード命令のとき, $op1 = 00$である.

行う動作は,
$$r[ra] = *(r[rb] + signext(d)) $$

### ストア命令

ストア命令のとき, $op1 = 01$である.

行う動作は,
$$*(r[rb] + signext(d)) = r[ra]$$

## 即値命令

### 即値ロード命令

即値ロード命令のとき,
$op1 = 10$
$ra = 001$
である.

行う動作は、
$$r[rb] = signext(d)$$

### 即値演算命令

即値演算命令では,

## 分岐命令

分岐命令は、I形式を用いる.


### 無条件分岐命令

無条件分岐命令のとき,
$op1 = 10$ $ra = 100$　である.
行う動作は,
$PC = PC + 1 + signext(d) $

### 条件分岐命令

条件分岐命令のとき、
$op1=10$ $ra = 111$ $rb = cond$ である.
行う動作は,
$if(cond) PC = PC + 1 + signext(d)$

## ジャンプ命令

ジャンプ命令のとき,

++++++++++++++

## 制御命令

++++++++++++++


# 構造と動作

回路図、入出力などを載せる
